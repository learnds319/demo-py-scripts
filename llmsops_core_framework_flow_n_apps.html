<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLMOps Core: Universal Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        
        .module-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .module-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-color: #3b82f6;
        }
        
        .arrow-down {
            width: 0; 
            height: 0; 
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #94a3b8;
            margin: 0 auto;
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-slate-900 text-white p-6 shadow-lg">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-2xl font-bold flex items-center gap-3">
                <span class="text-blue-400">llmops_core</span> 
                <span class="text-slate-500">/</span>
                <span>Universal Library Architecture</span>
            </h1>
            <p class="text-slate-400 mt-2">Standardizing Observability, Compliance, and Quality for ANY LLM Application.</p>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <!-- Diagram Area -->
        <div class="w-2/3 bg-slate-50 p-10 overflow-y-auto flex flex-col items-center">
            
            <!-- Consumers Layer -->
            <div class="flex gap-8 mb-4 w-full justify-center">
                <div class="bg-white border-2 border-slate-300 p-4 rounded-xl shadow-sm w-48 text-center opacity-70">
                    <div class="font-bold text-slate-700">App 1</div>
                    <div class="text-xs text-slate-500"></div>
                </div>
                <div class="bg-white border-2 border-slate-300 p-4 rounded-xl shadow-sm w-48 text-center opacity-70">
                    <div class="font-bold text-slate-700">App 2</div>
                    <div class="text-xs text-slate-500"></div>
                </div>
                <div class="bg-white border-2 border-slate-300 p-4 rounded-xl shadow-sm w-48 text-center opacity-40 border-dashed">
                    <div class="font-bold text-slate-700">App "N"</div>
                    <div class="text-xs text-slate-500">(Any Python App)</div>
                </div>
            </div>

            <!-- Connection Lines -->
            <div class="w-full flex justify-center mb-4">
                <div class="h-8 w-0.5 bg-slate-300"></div>
            </div>
            <div class="text-center text-xs font-bold text-slate-400 mb-2 uppercase tracking-widest">Integrates Via pip install</div>
            <div class="arrow-down mb-8"></div>

            <!-- THE CORE LIBRARY CONTAINER -->
            <div class="relative w-full max-w-5xl bg-white rounded-2xl shadow-xl border-2 border-blue-100 p-8">
                <div class="absolute -top-5 left-8 bg-blue-600 text-white px-4 py-2 rounded-full font-bold shadow-md">
                    ðŸ“¦ llmops_core Package
                </div>

                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mt-4">
                    
                    <!-- Module 1: Connection -->
                    <div onclick="showDetails('client')" class="module-card bg-slate-50 border border-slate-200 p-4 rounded-lg text-center group">
                        <div class="w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        </div>
                        <h3 class="font-bold text-slate-800">1. Client</h3>
                        <p class="text-xs text-slate-500 mt-1">Safe Connection & Circuit Breaker</p>
                    </div>

                    <!-- Module 2: Tracing -->
                    <div onclick="showDetails('tracing')" class="module-card bg-slate-50 border border-slate-200 p-4 rounded-lg text-center group">
                        <div class="w-10 h-10 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                        </div>
                        <h3 class="font-bold text-slate-800">2. Tracing</h3>
                        <p class="text-xs text-slate-500 mt-1">Auto-Logging Wrapper</p>
                    </div>

                    <!-- Module 3: Compliance -->
                    <div onclick="showDetails('compliance')" class="module-card bg-slate-50 border border-slate-200 p-4 rounded-lg text-center group">
                        <div class="w-10 h-10 bg-rose-100 text-rose-600 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-rose-600 group-hover:text-white transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                        </div>
                        <h3 class="font-bold text-slate-800">3. Compliance</h3>
                        <p class="text-xs text-slate-500 mt-1">PII/Data Sanitization</p>
                    </div>

                    <!-- Module 4: Prompts -->
                    <div onclick="showDetails('prompts')" class="module-card bg-slate-50 border border-slate-200 p-4 rounded-lg text-center group">
                        <div class="w-10 h-10 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-amber-600 group-hover:text-white transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                        </div>
                        <h3 class="font-bold text-slate-800">4. Prompts</h3>
                        <p class="text-xs text-slate-500 mt-1">Remote Management</p>
                    </div>

                    <!-- Module 5: Evaluation -->
                    <div onclick="showDetails('evaluation')" class="module-card bg-slate-50 border border-slate-200 p-4 rounded-lg text-center group">
                        <div class="w-10 h-10 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-3 group-hover:bg-emerald-600 group-hover:text-white transition-colors">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        </div>
                        <h3 class="font-bold text-slate-800">5. Evaluation</h3>
                        <p class="text-xs text-slate-500 mt-1">Quality & Regression</p>
                    </div>
                </div>

                <!-- Data Flow Visualization -->
                <div class="mt-8 pt-6 border-t border-slate-100 relative">
                    <div class="text-xs font-bold text-slate-400 mb-2">INTERNAL DATA FLOW</div>
                    <div class="flex items-center justify-between text-xs text-slate-500">
                        <div class="bg-slate-100 px-3 py-1 rounded">App Request</div>
                        <div class="h-0.5 w-16 bg-slate-300"></div>
                        <div class="bg-indigo-50 px-3 py-1 rounded border border-indigo-100">Tracing</div>
                        <div class="h-0.5 w-16 bg-slate-300"></div>
                        <div class="bg-rose-50 px-3 py-1 rounded border border-rose-100">Sanitize</div>
                        <div class="h-0.5 w-16 bg-slate-300"></div>
                        <div class="bg-blue-50 px-3 py-1 rounded border border-blue-100">Client (Send)</div>
                        <div class="h-0.5 w-16 bg-slate-300"></div>
                        <div class="bg-slate-100 px-3 py-1 rounded">Cloud</div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Detail Panel -->
        <div class="w-1/3 bg-white border-l border-slate-200 p-8 overflow-y-auto">
            <div id="detail-content">
                <div class="text-center text-slate-400 mt-20">
                    <svg class="w-16 h-16 mx-auto mb-4 text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <p>Select a module from the diagram<br>to view its internal design & tasks.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const modules = {
            client: {
                title: "1. Client Manager (client.py)",
                desc: "The foundation of the library. It handles the secure handshake with the external world.",
                tasks: [
                    "<strong>Circuit Breaker:</strong> Wrap connection logic in <code>try/except</code>. If Langfuse is unreachable, log error but do NOT raise exception.",
                    "<strong>Singleton Pattern:</strong> Ensure only one connection instance is created per application lifecycle.",
                    "<strong>Config Loader:</strong> Read standard env vars (<code>LLMOPS_PUBLIC_KEY</code>, etc.) automatically."
                ]
            },
            tracing: {
                title: "2. Tracing Wrapper (tracing.py)",
                desc: "The main interface developers will use. It serves as a 'Proxy' to the real AI client.",
                tasks: [
                    "<strong>OpenAI Wrapper:</strong> Create a class that mimics <code>openai.OpenAI</code>.",
                    "<strong>Auto-Tagging:</strong> Automatically inject <code>env</code>, <code>version</code>, and <code>user_id</code> into every trace metadata.",
                    "<strong>Token Counting:</strong> If not provided by API, estimate token usage for cost calculation."
                ]
            },
            compliance: {
                title: "3. Compliance (compliance.py)",
                desc: "The security middleware. It ensures PII compliance before data leaves the infrastructure.",
                tasks: [
                    "<strong>Regex Engine:</strong> Define patterns for SSN, Email, Phone.",
                    "<strong>Hook Integration:</strong> Connect this module to the <code>tracing.py</code> wrapper so it runs <em>before</em> the log is sent.",
                    "<strong>Configurable Rules:</strong> Allow apps to pass a custom list of patterns to redact."
                ]
            },
            prompts: {
                title: "4. Prompt Manager (prompts.py)",
                desc: "Decouples prompt text from application code.",
                tasks: [
                    "<strong>Fetch & Cache:</strong> Download prompts from Langfuse at startup and cache them.",
                    "<strong>Fallback Mechanism:</strong> If download fails, load from a local <code>defaults.json</code> file.",
                    "<strong>Variable Validation:</strong> Ensure all template variables (e.g. <code>{{name}}</code>) are present before compiling."
                ]
            },
            evaluation: {
                title: "5. Evaluation Kit (evaluation.py)",
                desc: "Tools to validate the quality of the AI's output.",
                tasks: [
                    "<strong>Regression Runner:</strong> A script to iterate through a 'Golden Dataset' and run the app's logic.",
                    "<strong>Scoring Utility:</strong> A helper function <code>log_score(trace_id, name, value)</code> to send quality metrics to the dashboard."
                ]
            }
        };

        function showDetails(key) {
            const data = modules[key];
            const container = document.getElementById('detail-content');
            
            container.innerHTML = `
                <div class="animate-fade-in">
                    <span class="text-xs font-bold uppercase tracking-wider text-blue-600 mb-2 block">Module Detail</span>
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">${data.title}</h2>
                    <p class="text-slate-600 mb-8 border-l-4 border-blue-200 pl-4 italic">
                        ${data.desc}
                    </p>
                    
                    <h3 class="font-bold text-slate-800 mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                        Implementation Tasks
                    </h3>
                    <ul class="space-y-4">
                        ${data.tasks.map(task => `
                            <li class="bg-slate-50 p-4 rounded-lg border border-slate-100 text-sm text-slate-700 shadow-sm">
                                ${task}
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `;
        }
        
        // Initialize
        showDetails('client');
    </script>
</body>
</html>